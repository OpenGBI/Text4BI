<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Box Plot with Outliers Example (No CSS)</title>
    <style>
      /* 添加样式来设置 div 容器的宽度和高度 */
      .boxplot-container {
        width: 800px;
        height: 600px;
      }

      svg {
        width: 100%; /* SVG 元素填充 div 容器 */
        height: 100%;
      }
    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
  </head>
  <body>
    <button id="highlightMedian">Highlight Median</button>
    <div id="svgContainer" style="width: 600px; height: 400px;"></div>
    <script>
      const data = [-10, 2, 4, 5, 1, 3, 7, 8.8, 10, 20];
      data.sort(d3.ascending);

      const q1 = d3.quantile(data, 0.25);
      const median = d3.quantile(data, 0.5);
      const q3 = d3.quantile(data, 0.75);
      const iqr = q3 - q1;
      const min = d3.min(data.filter((d) => d >= q1 - 1.5 * iqr));
      const max = d3.max(data.filter((d) => d <= q3 + 1.5 * iqr));
      const outliers = data.filter((d) => d < q1 - 1.5 * iqr || d > q3 + 1.5 * iqr);

      const svg = d3.select("#svgContainer").append("svg")
                    .attr("width", "600px")
                    .attr("height", "400px");
                    const margin = { top: 20, right: 30, bottom: 20, left: 30 };
      const width = +svg.attr("width").slice(0, -2) - margin.left - margin.right;
      const height = +svg.attr("height").slice(0, -2) - margin.top - margin.bottom;
      const g = svg.append("g").attr("transform", `translate(${margin.left},${margin.top})`);

      const x = d3.scaleLinear()
                  .domain([d3.min(data), d3.max(data)])
                  .range([0, width]);

      // Box
      g.append("rect")
        .attr("x", x(q1))
        .attr("y", 100)
        .attr("width", x(q3) - x(q1))
        .attr("height", 200)
        .style("fill", "lightblue")
        .classed("boxplot-element", true); // Class added for selection

      // Median Line
      const medianLine = g.append("line")
        .attr("x1", x(median))
        .attr("y1", 100)
        .attr("x2", x(median))
        .attr("y2", 300)
        .style("stroke", "black")
        .style("stroke-width", 2)
        .classed("median-line", true); // Class added for unique selection

      // Whiskers
      g.selectAll(".whisker") // Class added for selection
        .data([min, max])
        .enter()
        .append("line")
        .attr("x1", (d) => x(d))
        .attr("x2", (d) => x(d))
        .attr("y1", 100)
        .attr("y2", 300)
        .style("stroke", "black")
        .style("stroke-width", 2)
        .classed("boxplot-element", true);

      g.append("line")
        .attr("x1", x(min))
        .attr("x2", x(max))
        .attr("y1", 200)
        .attr("y2", 200)
        .style("stroke", "black")
        .style("stroke-width", 2)
        .classed("boxplot-element", true);

      // Outliers
      outliers.forEach(function (d) {
        g.append("circle")
          .attr("cx", x(d))
          .attr("cy", 200)
          .attr("r", 3)
          .style("fill", "red")
          .classed("boxplot-element", true); // Class added for selection
      });

      // Button click event
      d3.select("#highlightMedian").on("click", function() {
        d3.selectAll(".boxplot-element").style("opacity", 0.3); // Dim all other elements
        d3.select(".median-line").style("opacity", 1); // Highlight median line
      });




      
    </script>
  </body>
</html
